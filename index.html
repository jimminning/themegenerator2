<html ng-app="themeApp">
<head>
	<script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.0/jquery-ui.js"></script>	
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.13/angular.min.js"></script>
	<script src="scripts/bootstrap-colorpicker-module.js"></script>
	<script src="scripts/slider.js"></script>
	<link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" />
	<link rel="stylesheet" href="styles/colorpicker.css" />
	<link rel="stylesheet" href="styles/jqueryui.slider.css" />
	<style type="text/css">
		body{ padding:20px; }

		.ui-slider{
			background-color:#EDEDED;
			height:2px;
		}

		.ui-slider-handle{
			background-color:#444;
			margin-top:-4px;
		}
	</style>
	<script src="scripts/color.min.js"></script>	
	<script type="text/javascript">
		var themeApp = angular.module('themeApp', ['ui.slider','colorpicker.module']);

		themeApp.directive('colorChooser', function(){
			return{
				scope: {
					color:'=',
					label:'=',
					update:'='
				},
				templateUrl: '/templates/colorChooser.html'
			}
		});

		themeApp.factory('ColorSettings', [function(){
			/* Private */
			var stringMultiplyer = -1.5;
			var numberMultiplyer = -1.25;
			var preprocessorMultiplyer = 1.5;

			//maybe make a function instead
			var colorSettings = {
				main: null,
				foreground: null,
				background: null,
				contrast: null,
				update: function(){
					that = this; 

					//figure out if this is a dark or light background and set shade multiplyer
					//this multiplyer will be used against the colors to determine if you should rotate in a postive or negative direction
					var shadeMultiplyer =  Color(that.background).light() ? 1 : -1; 

					//do the math stuff to get the rest of them						
					that.color1 = Color(that.main).rotate(that.contrast / stringMultiplyer).hexString(); //magic
					that.color2 = Color(that.main).rotate(that.contrast / numberMultiplyer).hexString(); //magic
					that.color3 = that.main; //randomly this one is the same color as the main color in the original code.
					that.color4 = that.foreground; 
					that.color5 = Color(that.main).rotate(that.contrast/(-1 * shadeMultiplyer)).hexString(); 
					that.color6 = Color(that.color5).lighten(.20 * shadeMultiplyer).hexString();
					that.color7 = that.foreground; 
					that.color8 = that.background; 
					that.color9 = Color(that.main).rotate(that.contrast / preprocessorMultiplyer).hexString(); 

					that.comment = Color(that.foreground).rotate(shadeMultiplyer * 30).hexString(); 
					that.error =  Color("#F00").lighten(.40); 
				}
			}

			//this is messy - initializing
			colorSettings.main = "#2FCEFE"; 
			colorSettings.foreground = "#CFCFCF";
			colorSettings.background = "#383838";
			colorSettings.contrast = 110;
			colorSettings.update(); 

			return colorSettings; 
		}]);

		themeApp.controller('themeController', ['$scope', 'ColorSettings', function($scope, ColorSettings){
			//$scope.themeData = new themeData("#2FCEFE", "#CFCFCF", "#383838", 110);

			$scope.themeData = ColorSettings;

		   $scope.$watch('themeData.contrast', function() {
			$scope.themeData.update();
		   });

		}]);
	</script>
</head>
<body>
	<h1>Editor Theme Generator</h1>
	<!-- this whole thing is a mess but mostly in the original -- clean it up at some point in the near future -->
	<div ng-controller="themeController">
		<div ng-include="'templates/main.html'"></div>	
	</div>

</body>
</html>
